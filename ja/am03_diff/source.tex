\documentclass[a4paper]{ltjsarticle}
\usepackage{luacode}
\usepackage[box,completemulti,lang=JA]{automultiplechoice}
\begin{luacode}
  math.randomseed(190410)
\end{luacode}
% 乱数の種を設定する必要あり
\newcommand*{\var}[1]{\luadirect{tex.print(#1)}}
%%% document開始:
\begin{document}
\onecopy{2}{

%%% 試験問題用紙ヘッダー開始:    

\noindent{\bf 応用数学 演習03 \hfill 2019年4月17日}

\vspace{3ex}

{\small
  \setlength{\parindent}{0pt}\hspace*{\fill}\AMCcodeGridInt{学生番号}{8}\hspace*{\fill}
\begin{minipage}[b]{6.5cm}$\longleftarrow{}$\hspace{0ptplus1cm}
学生番号を左にマークし、氏名を下に記入してください。

\vspace{3ex}

\hfill\namefield{
  \fbox{
    \begin{minipage}{.9\linewidth}
      氏名\vspace*{.5cm}%\dotfill\vspace*{.5cm}\dotfill
      \vspace*{1mm}
    \end{minipage}
  }
}
\hfill\vspace{5ex}
\end{minipage}
\hspace*{\fill}
}

\vspace{1ex}
\hrulefill
\vspace{1ex}

%%% ヘッダー終了
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff01}
\directlua{
  a=math.random(2, 7);
  b=math.random(2, 7);
  c=math.random(2, 7);
  d=math.random(2, 7);
  e=math.random(1, 9);
}
函数\(f(x)=\var{a}x^{4}+\var{b}x^{3}+\var{c}x^{2}+\var{d}x+\var{e}\)の導函数\(f'(x)\)を求めなさい。
  \begin{choiceshoriz}
    \correctchoice{\(\var{4*a}x^{3}+\var{3*b}x^{2}+\var{2*c}x+\var{d}\)}
    \wrongchoice{\(\var{a}x^{4}+\var{b}x^{3}+\var{c}x^{2}+\var{d}x+\var{e}\)}
    \wrongchoice{\(\var{4*a}x^{3}+\var{3*b}x^{2}+\var{2*c}x+\var{d+e}\)}
    \wrongchoice{\(\var{a}x^{4}+\var{2*b}x^{3}+\var{c}x^{2}+\var{d}x\)}
    \wrongchoice{\(\var{4*a}x^{3}+\var{3*b}x^{2}+\var{2*c+2}x+\var{d}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff02}
\directlua{
  a=math.random(1, 5);
  b=math.random(1, 5);
  c=math.random(1, 5);
}
函数\(f(x)=\var{a}-\frac{\var{b}}{x}+\frac{\var{c}}{x^{2}}\)の導函数\(f'(x)\)を求めなさい。
  \begin{choiceshoriz}
    \correctchoice{\(\frac{\var{b}}{x^{2}}-\frac{\var{2*c}}{x^{3}}\)}
    \wrongchoice{\(-\frac{\var{b}}{x^{2}}+\frac{\var{2*c}}{x^{3}}\)}
    \wrongchoice{\(-\frac{\var{b}}{x^{2}}+\frac{\var{c}}{x^{3}}\)}
    \wrongchoice{\(\frac{\var{b}}{x^{2}}-\frac{\var{c}}{x^{3}}\)}
    \wrongchoice{\(\var{a}-\frac{\var{b}}{x}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff03}
\directlua{
  a=math.random(2, 3); % 分母
  array={5,7,11};
  i=math.random(1, 3);
  b=array[i]; % 分子
}
函数\(f(x)=x^{\frac{\var{b}}{\var{a}}}\)の導函数\(f'(x)\)を求めなさい。
  \begin{choiceshoriz}
    \correctchoice{\(\frac{\var{b}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}\)}
    \wrongchoice{\(\frac{\var{b-a}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}\)}
    \wrongchoice{\(\frac{\var{b+2}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}\)}
    \wrongchoice{\(\frac{\var{b-2}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}\)}
    \wrongchoice{\(\frac{\var{b}}{\var{a}} x^{\frac{\var{b}}{\var{a}}}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff04}
\directlua{
  a=math.random(2, 3); % 分母
  p=math.random(4, 6);
  array={7,11,13};
  i=math.random(1, 3);
  b=array[i]; % 分子
  j=math.random(1, 3);
  q=array[j];
}
函数\(f(x)=x^{\frac{\var{b}}{\var{a}}}-x^{-\frac{\var{q}}{\var{p}}}\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(\frac{\var{b}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}
      +\frac{\var{q}}{\var{p}}x^{-\frac{\var{p+q}}{\var{p}}}\)}
    \wrongchoice{\(\frac{\var{b}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}
      -\frac{\var{q}}{\var{p}}x^{-\frac{\var{p+q}}{\var{p}}}\)}
    \wrongchoice{\(\frac{\var{b-a}}{\var{a}} x^{\frac{\var{b}}{\var{a}}}
      +\frac{\var{q}}{\var{p}}x^{-\frac{\var{q-p}}{\var{p}}}\)}
    \wrongchoice{\(\frac{\var{b-a}}{\var{a}} x^{\frac{\var{b-a}}{\var{a}}}
      -\frac{\var{q}}{\var{p}}x^{\frac{\var{q-p}}{\var{p}}}\)}
    \wrongchoice{\(\frac{\var{b}}{\var{a}} x^{\frac{\var{b}}{\var{a}}}
      +\frac{\var{q}}{\var{p}}x^{-\frac{\var{q-p}}{\var{p}}}\)}
    \wrongchoice{\(\frac{\var{b}}{\var{a}} x^{-\frac{\var{b-a}}{\var{a}}}
      +\frac{\var{q}}{\var{p}}x^{-\frac{\var{q-p}}{\var{p}}}\)}
  \end{choiceshoriz}
\end{question}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff05}
\directlua{
  a=math.random(1, 5);
  b=math.random(1, 5);
  c=math.random(1, 7);
}
函数\(f(x)=(x^{2}+\var{a})(\var{b}x+\var{c})\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(\var{3*b}x^{2}+\var{2*c}x+\var{a*b}\)}
    \wrongchoice{\(\var{3*b}x^{2}+\var{2*c}x\)}
    \wrongchoice{\(\var{2*b}x\)}
    \wrongchoice{\(\var{3*b}x^{2}+\var{2*c}x+\var{a*b+1}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff06}
\directlua{
  a=math.random(2, 9);
  b=math.random(2, 9);
  c=math.random(2, 9);
}
函数\(f(x)=\frac{\var{e}}{\var{a}x^{2}+\var{b}x+\var{c}}\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(-\frac{\var{2*a*e}x+\var{b*e}}{(\var{a}x^{2}+\var{b}x+\var{c})^{2}}\)}
    \wrongchoice{\(\frac{\var{2*a*e}x+\var{b*e}}{(\var{a}x^{2}+\var{b}x+\var{c})^{2}}\)}
    \wrongchoice{\(-\frac{\var{2*a*e}x+\var{b*e}}{\var{a}x^{2}+\var{b}x+\var{c}}\)}
    \wrongchoice{\(\frac{\var{2*a*e}x+\var{b*e}}{\var{a}x^{2}+\var{b}x+\var{c}}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff07}
  \directlua{
    array1={2, 4, 8};
    array2={3, 5, 7, 11};
    i=math.random(1, 3);
    j=math.random(1, 4);
    k=math.random(1, 4);
    l=math.random(1, 3);
    a=array1[i];
    b=array2[j];
    c=array2[k];
    d=array1[l];
}
函数\(f(x)=\frac{\var{a}x+\var{b}}{\var{c}x+\var{d}}\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(\frac{\var{a*d-b*c}}{(\var{c}x+\var{d})^{2}}\)}
    \wrongchoice{\(\frac{\var{a}}{\var{c}x+\var{d}}\)}
    \wrongchoice{\(\frac{\var{a}}{(\var{c}x+\var{d})^{2}}\)}
    \wrongchoice{\(\frac{\var{(a+1)*d-b*c}}{\var{c}x+\var{d}}\)}
    \wrongchoice{\(\frac{\var{a*d-b*c}}{\var{c}x+\var{d}}\)}
  \end{choiceshoriz}
\end{question}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff08}
\directlua{
  a=math.random(2, 9);
  b=math.random(2, 9);
  c=math.random(7, 12);
}
函数\(f(x)=(\var{a}x+\var{b})^{\var{c}}\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(\var{a*c}(\var{a}x+\var{b})^{\var{c-1}}\)}
    \wrongchoice{\(\var{c}(\var{a}x+\var{b})^{\var{c-1}}\)}
    \wrongchoice{\(\var{a*c}(\var{a}x+\var{b})^{\var{c}}\)}
    \wrongchoice{\(\var{c}(\var{a}x+\var{b})^{\var{c}}\)}
  \end{choiceshoriz}
\end{question}

% \AMCaddpagesto{3} 
}
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{question}{diff08}
\directlua{
  a=math.random(3, 6);
}
函数\(f(x)=e^{-\frac{x^{\var{a}}}{\var{a}}}\)の導函数\(f'(x)\)を求めなさい。

  \begin{choiceshoriz}
    \correctchoice{\(-x^{\var{a-1}}e^{-\frac{x^\var{a}}{\var{a}}}\)}
    \wrongchoice{\(-\frac{x^{\var{a}}}{\var{a}}e^{-\frac{x^{\var{a}}}{\var{a}}-1}\)}
    \wrongchoice{\(x^{\var{a-1}}e^{-\frac{x^\var{a}}{\var{a}}}\)}
    \wrongchoice{\(e^{-\frac{x^\var{a}}{\var{a}}-1}\)}
  \end{choiceshoriz}
\end{question}

